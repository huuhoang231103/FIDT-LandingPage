<!DOCTYPE html>
<html>
<head>
    <title>Google Apps Script Test</title>
</head>
<body>
    <h1>Google Apps Script Test</h1>
    
    <div id="result"></div>
    
    <script>
        // Test data
        const testData = {
            name: 'Test User',
            phone: '0123456789',
            email: 'test@example.com',
            service: 'MUA BĐS ĐẦU TIÊN',
            message: 'This is a test message from browser',
            subscribe: true
        };
        
        // Replace this with your actual Google Apps Script URL
        const scriptUrl = 'https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLiAGnBwTw90JDRlRQQareeOb_xibhDhdB_gX4QZ_mfR3n2daZzSE8YdWBQr1GDtsduAuOAF4F-WZ9egse8HkR5wltVnuZtXmxf8mph5r1ykOdObHHO9SXkFvWwQ8L-kUVh6MYsea0Fl7W3VjePbPe8C-8bEfEbycUsnlJbjm51xSiug6BHUturepwAEtU-uox74RxoblrdghQUjmomOtjSrv0YgOKvMwJxglngPVywQJFzuvC44RGEtNOYEIw0rExY2_iCRCwAaXONrWJjWKod41nddEQ&lib=MZLRrcFYPE6clKlIeKkHQJ86idZU4jP8o';
        
        async function testGoogleScript() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testing...';
            
            try {
                const response = await fetch(scriptUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                });
                
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <h3>Response:</h3>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                    <p><strong>Status:</strong> ${response.status}</p>
                    <p><strong>Success:</strong> ${data.result === 'success' ? '✅ Yes' : '❌ No'}</p>
                `;
                
                if (data.result === 'success') {
                    resultDiv.innerHTML += '<p style="color: green;">✅ Data sent successfully! Check your Google Sheet.</p>';
                } else {
                    resultDiv.innerHTML += '<p style="color: red;">❌ Error: ' + (data.error || 'Unknown error') + '</p>';
                }
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <h3>Error:</h3>
                    <p style="color: red;">❌ ${error.message}</p>
                    <p>This might be a CORS issue or the URL is incorrect.</p>
                `;
            }
        }
        
        // Test GET request first
        async function testGet() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testing GET request...';
            
            try {
                const response = await fetch(scriptUrl);
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <h3>GET Response:</h3>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                    <p><strong>Status:</strong> ${response.status}</p>
                    <button onclick="testGoogleScript()">Now Test POST Request</button>
                `;
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <h3>GET Error:</h3>
                    <p style="color: red;">❌ ${error.message}</p>
                    <p>The script URL might be incorrect.</p>
                `;
            }
        }
        
        // Start with GET test
        testGet();
    </script>
</body>
</html>
